pipeline {
    agent any
    environment {
        SONAR_HOME = 'C:\\Users\\Administrator\\Desktop\\Narayanan-apps\\tools\\sonar-scanner-cli-7.1.0.4889-windows-x64\\sonar-scanner-7.1.0.4889-windows-x64\\bin'
        REPO_NAME='https://github.com/NarayananDurai07/html-sample-app.git'
        BRANCH_NAME ='master'
    }

    stages {   
         // stage1
        stage('Hello') {
            steps {
                echo 'Hello World'
            }
        }    
        // stage to verify sonar-scanner 
        stage('sonar-scaner verify'){
             steps {
                echo 'checking version'
                // bat or pwsh
                //%SONAR_HOME%\\
                bat """
                C:\\Users\\Administrator\\Desktop\\Narayanan-apps\\tools\\sonar-scanner-cli-7.1.0.4889-windows-x64\\sonar-scanner-7.1.0.4889-windows-x64\\bin\\sonar-scanner --version
                docker version
                java --version 
                """
            }
         }
         stage("git checkout")
         {
            steps{
                echo 'Git checkout'
                git url: "${REPO_NAME}", branch: "${BRANCH_NAME}"
            }
         }
         stage('SAST'){
            steps{
                echo 'SAST'
                bat """
                %SONAR_HOME%\\sonar-scanner.bat -D"sonar.projectKey=Narayanan_scan2" -D"sonar.sources=." 
                -D"sonar.host.url=http://13.203.151.240:9000" -D"sonar.token=sqp_55249b1342fcb458426c4eea5ecae2767ff03b97"
                """
            }
         }
    }
}